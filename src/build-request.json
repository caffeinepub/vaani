{
  "kind": "build_request",
  "title": "Fix useAuth crash by mounting AuthProvider above RouterProvider for entire app tree",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-72",
      "text": "Move `AuthProvider` to the absolute top of the React app tree so it unconditionally wraps `RouterProvider` and therefore all routes/components (including `CreatorZoneTab`), eliminating the runtime crash `Uncaught Error: useAuth must be used within AuthProvider` during login/logout transitions.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-latest"
        ],
        "quotes": [
          "Required fix (no alternatives):\n- Move AuthProvider to the absolute top of the app tree\n- AuthProvider must wrap RouterProvider AND all routes\n- Ensure CreatorZoneTab never renders outside AuthProvider\n- Do NOT rely on conditional rendering for provider presence"
        ]
      },
      "acceptanceCriteria": [
        "`frontend/src/main.tsx` no longer renders `<App />` directly; the routed application is rendered via TanStack Routerâ€™s `RouterProvider` using the existing `router`/`routeTree`.",
        "The mounted provider order ensures `AuthProvider` wraps `RouterProvider` (and thus all routed content) without any conditional rendering of provider presence.",
        "Reproducing the prior flow (initial load, then login, then logout) no longer produces the console error `useAuth must be used within AuthProvider`, and the UI does not blank/white-screen.",
        "`CreatorZoneTab` (and any other `useAuth()` consumer) is never rendered outside `AuthProvider` at any point during transitions."
      ]
    },
    {
      "id": "REQ-73",
      "text": "Audit and remove any duplicate/nested `AuthProvider` placements (if any exist) so there is exactly one `AuthProvider` instance wrapping the entire routed tree; ensure no route/layout/component can mount outside it.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-latest"
        ],
        "quotes": [
          "This confirms that CreatorZoneTab is rendering outside AuthProvider during login/logout transitions."
        ]
      },
      "acceptanceCriteria": [
        "There is a single, top-level `AuthProvider` for the application; no nested/duplicate `AuthProvider` instances remain in route/layout/component trees.",
        "No component that calls `useAuth()` can be reached/rendered unless it is a descendant of the single top-level `AuthProvider`."
      ]
    },
    {
      "id": "REQ-74",
      "text": "Redeploy a new version after applying the structural provider-order fix and verify the fix in the deployed environment (not just local dev).",
      "target": "unknown",
      "source": {
        "messageIds": [
          "msg-user-latest"
        ],
        "quotes": [
          "Apply this structural fix and redeploy a new version."
        ]
      },
      "acceptanceCriteria": [
        "A new deployed version is produced after the provider-order change.",
        "In the deployed version, the app no longer shows a blank screen and the console no longer logs `Uncaught Error: useAuth must be used within AuthProvider` originating from `CreatorZoneTab`."
      ]
    }
  ],
  "constraints": [
    "Do not rely on conditional rendering to determine whether `AuthProvider` is present; it must always be mounted at the top level.",
    "`AuthProvider` must wrap `RouterProvider` AND all routes/components.",
    "Do not change route definitions/paths; keep existing `/` and `/studio` routes as defined in the current `routeTree`.",
    "Do not change backend code or backend behavior.",
    "Do not introduce any new routes (specifically, do not introduce or use `/creator-zone`).",
    "Keep all user-facing text in English."
  ],
  "nonGoals": [
    "Adding new product features beyond fixing the provider placement and redeploying.",
    "Refactoring unrelated UI/role logic; the scope is limited to ensuring correct provider structure so `useAuth()` never runs outside `AuthProvider`.",
    "Modifying compiled/bundled build artifacts directly."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}